{% extends "base.html" %}
{% load static %}
{% block title %}Checkout – {{ service.title }}{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2 class="mb-3">Checkout for {{ service.title }}</h2>
  <p class="lead">Price: ${{ service.price }}</p>

  {# show any Django messages #}
  {% if messages %}
  <div class="mb-3">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
  </div>
  {% endif %}

  <form method="post" action="{% url 'service:process_payment' service.slug %}" class="needs-validation" novalidate>
    {% csrf_token %}

    <div class="mb-3">
      <label for="full_name" class="form-label">Full Name</label>
      <input id="full_name" type="text" name="full_name" class="form-control"
        value="{{ request.user.get_full_name|default:'' }}" required>
      <div class="invalid-feedback">Please enter your full name.</div>
    </div>

    <div class="mb-3">
      <label for="email" class="form-label">Email</label>
      <input id="email" type="email" name="email" class="form-control" value="{{ request.user.email|default:'' }}"
        required>
      <div class="invalid-feedback">A valid email is required.</div>
    </div>

    {# Optional notes field #}
    <div class="mb-3">
      <label for="notes" class="form-label">Notes (optional)</label>
      <textarea id="notes" name="notes" class="form-control" rows="3"></textarea>
    </div>

    <button type="submit" class="btn btn-success w-100">
      Proceed to Pay ${{ service.price }}
    </button>
  </form>

  <hr class="my-4">
  <p class="small text-muted">
    You will be redirected to a secure Stripe Checkout page.
    After payment you’ll return to <code>{% url 'service:payment_success' %}</code>.
    If canceled, you’ll go to <code>{% url 'service:payment_cancel' %}</code>.
  </p>
</div>


{% endblock %}